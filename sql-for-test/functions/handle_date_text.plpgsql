DECLARE
  d date;
  part1 int;
  part2 int;
BEGIN
  -- Case YYYYMMDD
  IF date_text ~ '^\d{8}$' THEN
    BEGIN
      d := to_date(date_text, 'YYYYMMDD');
      RETURN d;
    EXCEPTION WHEN others THEN
      RETURN NULL;
    END;
  END IF;

  -- If not dd/mm/yyyy or mm/dd/yyyy return NULL
  IF date_text !~ '^\d{1,2}/\d{1,2}/\d{4}$' THEN
    RETURN NULL;
  END IF;

  part1 := split_part(date_text, '/', 1)::int;
  part2 := split_part(date_text, '/', 2)::int;

  -- MM/DD/YYYY
  IF part2 > 12 THEN
    BEGIN
      d := to_date(date_text, 'MM/DD/YYYY');
      RETURN d;
    EXCEPTION WHEN others THEN
      RETURN NULL;
    END;
  ELSE
    -- DD/MM/YYYY
    BEGIN
      d := to_date(date_text, 'DD/MM/YYYY');
      RETURN d;
    EXCEPTION WHEN others THEN
      RETURN NULL;
    END;
  END IF;
END;